{"version":3,"file":"stack.mjs","names":["useToggleScope","computed","onScopeDispose","reactive","readonly","ref","toRaw","watchEffect","getCurrentInstance","stack","useStack","isActive","zIndex","vm","_zIndex","value","lastZIndex","length","push","idx","findIndex","v","splice","isTop","_isTop","setTimeout","stackStyles"],"sources":["../../src/composables/stack.ts"],"sourcesContent":["import { useToggleScope } from '@/composables/toggleScope'\n\nimport { computed, onScopeDispose, reactive, readonly, ref, toRaw, watchEffect } from 'vue'\nimport { getCurrentInstance } from '@/util'\n\n// Types\nimport type { ComponentInternalInstance, Ref } from 'vue'\n\nconst stack = reactive<[vm: ComponentInternalInstance, zIndex: number][]>([])\n\nexport function useStack (isActive: Readonly<Ref<boolean>>, zIndex: Readonly<Ref<string | number>>) {\n  const vm = getCurrentInstance('useStack')\n\n  const _zIndex = ref(+zIndex.value)\n  useToggleScope(isActive, () => {\n    const lastZIndex = stack[stack.length - 1]?.[1]\n    _zIndex.value = lastZIndex ? lastZIndex + 10 : +zIndex.value\n    stack.push([vm, _zIndex.value])\n\n    onScopeDispose(() => {\n      const idx = stack.findIndex(v => v[0] === vm)\n      stack.splice(idx, 1)\n    })\n  })\n\n  const isTop = ref(true)\n  watchEffect(() => {\n    const _isTop = toRaw(stack[stack.length - 1]?.[0]) === vm\n    setTimeout(() => isTop.value = _isTop)\n  })\n\n  return {\n    isTop: readonly(isTop),\n    stackStyles: computed(() => ({ zIndex: _zIndex.value })),\n  }\n}\n"],"mappings":"SAASA,c;AAET,SAASC,QAAT,EAAmBC,cAAnB,EAAmCC,QAAnC,EAA6CC,QAA7C,EAAuDC,GAAvD,EAA4DC,KAA5D,EAAmEC,WAAnE,QAAsF,KAAtF;SACSC,kB,6BAET;;AAGA,MAAMC,KAAK,GAAGN,QAAQ,CAAoD,EAApD,CAAtB;AAEA,OAAO,SAASO,QAAT,CAAmBC,QAAnB,EAAqDC,MAArD,EAA6F;EAClG,MAAMC,EAAE,GAAGL,kBAAkB,CAAC,UAAD,CAA7B;;EAEA,MAAMM,OAAO,GAAGT,GAAG,CAAC,CAACO,MAAM,CAACG,KAAT,CAAnB;;EACAf,cAAc,CAACW,QAAD,EAAW,MAAM;IAAA;;IAC7B,MAAMK,UAAU,aAAGP,KAAK,CAACA,KAAK,CAACQ,MAAN,GAAe,CAAhB,CAAR,qBAAG,OAA0B,CAA1B,CAAnB;IACAH,OAAO,CAACC,KAAR,GAAgBC,UAAU,GAAGA,UAAU,GAAG,EAAhB,GAAqB,CAACJ,MAAM,CAACG,KAAvD;IACAN,KAAK,CAACS,IAAN,CAAW,CAACL,EAAD,EAAKC,OAAO,CAACC,KAAb,CAAX;IAEAb,cAAc,CAAC,MAAM;MACnB,MAAMiB,GAAG,GAAGV,KAAK,CAACW,SAAN,CAAgBC,CAAC,IAAIA,CAAC,CAAC,CAAD,CAAD,KAASR,EAA9B,CAAZ;MACAJ,KAAK,CAACa,MAAN,CAAaH,GAAb,EAAkB,CAAlB;IACD,CAHa,CAAd;EAID,CATa,CAAd;EAWA,MAAMI,KAAK,GAAGlB,GAAG,CAAC,IAAD,CAAjB;EACAE,WAAW,CAAC,MAAM;IAAA;;IAChB,MAAMiB,MAAM,GAAGlB,KAAK,YAACG,KAAK,CAACA,KAAK,CAACQ,MAAN,GAAe,CAAhB,CAAN,qBAAC,QAA0B,CAA1B,CAAD,CAAL,KAAwCJ,EAAvD;;IACAY,UAAU,CAAC,MAAMF,KAAK,CAACR,KAAN,GAAcS,MAArB,CAAV;EACD,CAHU,CAAX;EAKA,OAAO;IACLD,KAAK,EAAEnB,QAAQ,CAACmB,KAAD,CADV;IAELG,WAAW,EAAEzB,QAAQ,CAAC,OAAO;MAAEW,MAAM,EAAEE,OAAO,CAACC;IAAlB,CAAP,CAAD;EAFhB,CAAP;AAID"}